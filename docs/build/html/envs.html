

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lagom.envs &mdash; lagom 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lagom.experiment" href="experiment.html" />
    <link rel="prev" title="lagom.engine" href="engine.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> lagom
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing lagom</a></li>
</ul>
<p class="caption"><span class="caption-text">lagom API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="lagom.html">lagom</a></li>
<li class="toctree-l1"><a class="reference internal" href="agents.html">lagom.agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">lagom.contrib</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">lagom.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="engine.html">lagom.engine</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">lagom.envs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#spaces">Spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment">Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wrappers">Wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vectorized-environment">Vectorized Environment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="experiment.html">lagom.experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="runner.html">lagom.runner</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">lagom</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>lagom.envs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/envs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-lagom.envs">
<span id="lagom-envs"></span><h1>lagom.envs<a class="headerlink" href="#module-lagom.envs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="spaces">
<h2>Spaces<a class="headerlink" href="#spaces" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="lagom.envs.spaces.Space">
<em class="property">class </em><code class="descclassname">lagom.envs.spaces.</code><code class="descname">Space</code><span class="sig-paren">(</span><em>shape=None</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/space.html#Space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Space" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for observation and action space e.g. applied to Env.</p>
<p>All inherited subclasses should at least implement the following functions:
1. sample(self)
2. &#64;property: flat_dim(self)
3. flatten(self, x)
4. unflatten(self, x)
5. contains(self, x)</p>
<dl class="method">
<dt id="lagom.envs.spaces.Space.contains">
<code class="descname">contains</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/space.html#Space.contains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Space.contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is contained in this space.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.spaces.Space.flat_dim">
<code class="descname">flat_dim</code><a class="headerlink" href="#lagom.envs.spaces.Space.flat_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a flattened dimension</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Space.flatten">
<code class="descname">flatten</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/space.html#Space.flatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Space.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the flattened x.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Space.sample">
<code class="descname">sample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/space.html#Space.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Space.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Uniformly sample an element from this space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Space.unflatten">
<code class="descname">unflatten</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/space.html#Space.unflatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Space.unflatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the unflattened x according to defined shape</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.spaces.Discrete">
<em class="property">class </em><code class="descclassname">lagom.envs.spaces.</code><code class="descname">Discrete</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/discrete.html#Discrete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Discrete" title="Permalink to this definition">¶</a></dt>
<dd><p>A discrete space in {0, 1, …, n-1}.</p>
<dl class="method">
<dt id="lagom.envs.spaces.Discrete.contains">
<code class="descname">contains</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/discrete.html#Discrete.contains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Discrete.contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is contained in this space.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.spaces.Discrete.flat_dim">
<code class="descname">flat_dim</code><a class="headerlink" href="#lagom.envs.spaces.Discrete.flat_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a flattened dimension</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Discrete.flatten">
<code class="descname">flatten</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/discrete.html#Discrete.flatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Discrete.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the flattened x.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Discrete.sample">
<code class="descname">sample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/discrete.html#Discrete.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Discrete.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Uniformly sample an element from this space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Discrete.unflatten">
<code class="descname">unflatten</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/discrete.html#Discrete.unflatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Discrete.unflatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the unflattened x according to defined shape</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.spaces.Box">
<em class="property">class </em><code class="descclassname">lagom.envs.spaces.</code><code class="descname">Box</code><span class="sig-paren">(</span><em>low</em>, <em>high</em>, <em>shape=None</em>, <em>dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/box.html#Box"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Box" title="Permalink to this definition">¶</a></dt>
<dd><p>A continuous space in R^n. Each dimension is bounded by low/high.</p>
<dl class="method">
<dt id="lagom.envs.spaces.Box.contains">
<code class="descname">contains</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/box.html#Box.contains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Box.contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is contained in this space.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.spaces.Box.flat_dim">
<code class="descname">flat_dim</code><a class="headerlink" href="#lagom.envs.spaces.Box.flat_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a flattened dimension</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Box.flatten">
<code class="descname">flatten</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/box.html#Box.flatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Box.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the flattened x.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Box.sample">
<code class="descname">sample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/box.html#Box.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Box.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Uniformly sample an element from this space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Box.unflatten">
<code class="descname">unflatten</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/box.html#Box.unflatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Box.unflatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the unflattened x according to defined shape</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.spaces.Product">
<em class="property">class </em><code class="descclassname">lagom.envs.spaces.</code><code class="descname">Product</code><span class="sig-paren">(</span><em>spaces</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/product.html#Product"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Product" title="Permalink to this definition">¶</a></dt>
<dd><p>A product (tuple) of elementary spaces.</p>
<dl class="method">
<dt id="lagom.envs.spaces.Product.contains">
<code class="descname">contains</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/product.html#Product.contains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Product.contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is contained in this space.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.spaces.Product.flat_dim">
<code class="descname">flat_dim</code><a class="headerlink" href="#lagom.envs.spaces.Product.flat_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a flattened dimension</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Product.flatten">
<code class="descname">flatten</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/product.html#Product.flatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Product.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the flattened x.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Product.sample">
<code class="descname">sample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/product.html#Product.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Product.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Uniformly sample an element from this space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Product.unflatten">
<code class="descname">unflatten</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/product.html#Product.unflatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Product.unflatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the unflattened x according to defined shape</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.spaces.Dict">
<em class="property">class </em><code class="descclassname">lagom.envs.spaces.</code><code class="descname">Dict</code><span class="sig-paren">(</span><em>spaces</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/dict.html#Dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Dict" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of elementary spaces.</p>
<dl class="docutils">
<dt>Simple example:</dt>
<dd>Dict({‘position’: Discrete(2), ‘velocity’: Discrete(3)})</dd>
<dt>Nested example:</dt>
<dd><dl class="first last docutils">
<dt>Dict({</dt>
<dd><dl class="first docutils">
<dt>‘sensors’: Dict({</dt>
<dd>‘position’: Box(low=-10, high=10, shape=(3,), dtype=np.float32),
‘velocity’: Box(low=-1, high=1, shape=(3,), dtype=np.float32)
})</dd>
</dl>
<p class="last">})</p>
</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="lagom.envs.spaces.Dict.contains">
<code class="descname">contains</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/dict.html#Dict.contains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Dict.contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if x is contained in this space.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.spaces.Dict.flat_dim">
<code class="descname">flat_dim</code><a class="headerlink" href="#lagom.envs.spaces.Dict.flat_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a flattened dimension</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Dict.flatten">
<code class="descname">flatten</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/dict.html#Dict.flatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Dict.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the flattened x.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Dict.sample">
<code class="descname">sample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/dict.html#Dict.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Dict.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Uniformly sample an element from this space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.spaces.Dict.unflatten">
<code class="descname">unflatten</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/spaces/dict.html#Dict.unflatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.spaces.Dict.unflatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Unflatten the vector into Dict space. Note that the order must be consistent with self.spaces.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="environment">
<h2>Environment<a class="headerlink" href="#environment" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="lagom.envs.Env">
<em class="property">class </em><code class="descclassname">lagom.envs.</code><code class="descname">Env</code><a class="reference internal" href="_modules/lagom/envs/env.html#Env"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.Env" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for environment</p>
<p>All inherited subclasses should at least implement the following functions:
1. step(self, action)
2. reset(self)
3. render(self, mode=’human’)
4. close(self)
5. seed(self, seed)
6. &#64;property: T(self)
7. &#64;property: max_episode_reward(self)
8. &#64;property: observation_space(self)
9. &#64;property: action_space(self)</p>
<dl class="attribute">
<dt id="lagom.envs.Env.T">
<code class="descname">T</code><a class="headerlink" href="#lagom.envs.Env.T" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum horizon of the environment, if available</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.Env.action_space">
<code class="descname">action_space</code><a class="headerlink" href="#lagom.envs.Env.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the action space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.Env.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/env.html#Env.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.Env.close" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be automatically called when garbage collected or program exited.</p>
<p>Override this method to do any further cleanup.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.Env.max_episode_reward">
<code class="descname">max_episode_reward</code><a class="headerlink" href="#lagom.envs.Env.max_episode_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum episodic rewards of the environment, if available</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.Env.observation_space">
<code class="descname">observation_space</code><a class="headerlink" href="#lagom.envs.Env.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the observation space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.Env.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>mode='human'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/env.html#Env.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.Env.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mode (str): The mode for the rendering. Two modes are supported.</dt>
<dd><ul class="first last simple">
<li>‘human’: Often pop up a rendered window</li>
<li>‘rgb_array’: numpy array with shape [x, y, 3] for RGB values.</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.Env.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/env.html#Env.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.Env.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the environment and return an initial observation.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observation (object): The observation agents receives for the initial state.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.Env.seed">
<code class="descname">seed</code><span class="sig-paren">(</span><em>seed</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/env.html#Env.seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.Env.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the random seed of the environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>seed (int): The seed to initialize the pseudo-random number generator.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.Env.step">
<code class="descname">step</code><span class="sig-paren">(</span><em>action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/env.html#Env.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.Env.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the given action for one time step through the environment’s dynamics.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>action (object): a given action to the environment</dd>
<dt>Returns:</dt>
<dd>observation (object): The current observation agent receives after executing the given action.
reward (float): A scalar reward signal
done (bool): True if the episode terminates.
info (dict): Debugging information.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.Env.unwrapped">
<code class="descname">unwrapped</code><a class="headerlink" href="#lagom.envs.Env.unwrapped" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwrap this environment. Useful for sequential wrappers applied, it can access information from the original environment.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.EnvSpec">
<em class="property">class </em><code class="descclassname">lagom.envs.</code><code class="descname">EnvSpec</code><span class="sig-paren">(</span><em>env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/env_spec.html#EnvSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.EnvSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Create specifications of the environment.</p>
<p>Currently supported:
- observation_space: observation space
- action_space: action space
- T: maximum allowed horizon
- max_episode_reward: maximum episode reward
- control_type: ‘Discrete’ or ‘Continuous’ control</p>
</dd></dl>

<dl class="class">
<dt id="lagom.envs.GoalEnv">
<em class="property">class </em><code class="descclassname">lagom.envs.</code><code class="descname">GoalEnv</code><a class="reference internal" href="_modules/lagom/envs/goal_env.html#GoalEnv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.GoalEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>A goal-based environment. The observation space is a dictionary space consisting of 
- ‘observation’: same like regular observation
- ‘achieved_goal’: the goal is currently achieved by the agent
- ‘desired_goal’: the goal should be achieved by the agent</p>
<dl class="method">
<dt id="lagom.envs.GoalEnv.compute_reward">
<code class="descname">compute_reward</code><span class="sig-paren">(</span><em>achieved_goal</em>, <em>desired_goal</em>, <em>info</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/goal_env.html#GoalEnv.compute_reward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.GoalEnv.compute_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the step reward dependent on a desired goal and a goal that was achieved.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>achieved_goal (object): the goal that was achieved
desired_goal (object): the desired goal that agent should achieve
info (dict): additional information, e.g. additional rewards that are independent of goal.</dd>
<dt>Returns:</dt>
<dd><dl class="first last docutils">
<dt>reward (float): the reward according to achieved goal and desired goal.</dt>
<dd><dl class="first last docutils">
<dt>Note that the following should be true:</dt>
<dd>observation, reward, done, info = env.step()
assert reward == env.compute_reward(observation[‘achieved_goal’], observation[‘desired_goal’], info)</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.GoalEnv.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/goal_env.html#GoalEnv.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.GoalEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the environment and return an initial observation.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observation (object): The observation agents receives for the initial state.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.GymEnv">
<em class="property">class </em><code class="descclassname">lagom.envs.</code><code class="descname">GymEnv</code><span class="sig-paren">(</span><em>env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/gym_env.html#GymEnv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.GymEnv" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="lagom.envs.GymEnv.T">
<code class="descname">T</code><a class="headerlink" href="#lagom.envs.GymEnv.T" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum horizon of the environment, if available</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.GymEnv.action_space">
<code class="descname">action_space</code><a class="headerlink" href="#lagom.envs.GymEnv.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the action space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.GymEnv.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/gym_env.html#GymEnv.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.GymEnv.close" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be automatically called when garbage collected or program exited.</p>
<p>Override this method to do any further cleanup.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.GymEnv.max_episode_reward">
<code class="descname">max_episode_reward</code><a class="headerlink" href="#lagom.envs.GymEnv.max_episode_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum episodic rewards of the environment, if available</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.GymEnv.observation_space">
<code class="descname">observation_space</code><a class="headerlink" href="#lagom.envs.GymEnv.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the observation space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.GymEnv.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>mode='human'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/gym_env.html#GymEnv.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.GymEnv.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mode (str): The mode for the rendering. Two modes are supported.</dt>
<dd><ul class="first last simple">
<li>‘human’: Often pop up a rendered window</li>
<li>‘rgb_array’: numpy array with shape [x, y, 3] for RGB values.</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.GymEnv.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/gym_env.html#GymEnv.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.GymEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the environment and return an initial observation.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observation (object): The observation agents receives for the initial state.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.GymEnv.seed">
<code class="descname">seed</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/gym_env.html#GymEnv.seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.GymEnv.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the random seed of the environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>seed (int): The seed to initialize the pseudo-random number generator.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.GymEnv.step">
<code class="descname">step</code><span class="sig-paren">(</span><em>action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/gym_env.html#GymEnv.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.GymEnv.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the given action for one time step through the environment’s dynamics.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>action (object): a given action to the environment</dd>
<dt>Returns:</dt>
<dd>observation (object): The current observation agent receives after executing the given action.
reward (float): A scalar reward signal
done (bool): True if the episode terminates.
info (dict): Debugging information.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.GymEnv.unwrapped">
<code class="descname">unwrapped</code><a class="headerlink" href="#lagom.envs.GymEnv.unwrapped" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwrap this environment. Useful for sequential wrappers applied, it can access information from the original environment.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="lagom.envs.make_gym_env">
<code class="descclassname">lagom.envs.</code><code class="descname">make_gym_env</code><span class="sig-paren">(</span><em>env_id</em>, <em>seed</em>, <em>monitor=False</em>, <em>monitor_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/make_env.html#make_gym_env"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.make_gym_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a gym environment, wrap it with GymEnv and seed it.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>env_id (str): environment ID, e.g. ‘Pendulum-v0’
seed (int): random seed
monitor (bool, optional): Whether to wrap the environment with Monitor for video recording. 
monitor_dir (str, optional): directory to save all data from Monitor.</dd>
<dt>Returns:</dt>
<dd>env (GymEnv): created environment</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="lagom.envs.make_envs">
<code class="descclassname">lagom.envs.</code><code class="descname">make_envs</code><span class="sig-paren">(</span><em>make_env</em>, <em>env_id</em>, <em>num_env</em>, <em>init_seed</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/make_env.html#make_envs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.make_envs" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a list of argument-free make_env() given the settings.</p>
<p>Each make_env function in the list uses different random seeds generated by Seeder.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>make_env (function): A function to create an environment
env_id (str): environment ID, e.g. ‘Pendulum-v0’. 
num_env (int): Number of environments to create. 
init_seed (int): Initial seed for Seeder to sample random seeds. 
<a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs: keyword aguments used to specify other options for make_env.</dd>
<dt>Returns:</dt>
<dd><dl class="first last docutils">
<dt>list_make_env (list): A list of argument-free make_env() functions, each with different random</dt>
<dd>seed.</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="wrappers">
<h2>Wrappers<a class="headerlink" href="#wrappers" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="lagom.envs.wrappers.Wrapper">
<em class="property">class </em><code class="descclassname">lagom.envs.wrappers.</code><code class="descname">Wrapper</code><span class="sig-paren">(</span><em>env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#Wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.Wrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="lagom.envs.wrappers.Wrapper.T">
<code class="descname">T</code><a class="headerlink" href="#lagom.envs.wrappers.Wrapper.T" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum horizon of the environment, if available</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.wrappers.Wrapper.action_space">
<code class="descname">action_space</code><a class="headerlink" href="#lagom.envs.wrappers.Wrapper.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the action space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.wrappers.Wrapper.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#Wrapper.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.Wrapper.close" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be automatically called when garbage collected or program exited.</p>
<p>Override this method to do any further cleanup.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.wrappers.Wrapper.observation_space">
<code class="descname">observation_space</code><a class="headerlink" href="#lagom.envs.wrappers.Wrapper.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the observation space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.wrappers.Wrapper.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>mode='human'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#Wrapper.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.Wrapper.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mode (str): The mode for the rendering. Two modes are supported.</dt>
<dd><ul class="first last simple">
<li>‘human’: Often pop up a rendered window</li>
<li>‘rgb_array’: numpy array with shape [x, y, 3] for RGB values.</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.wrappers.Wrapper.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#Wrapper.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.Wrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the environment and return an initial observation.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observation (object): The observation agents receives for the initial state.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.wrappers.Wrapper.seed">
<code class="descname">seed</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#Wrapper.seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.Wrapper.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the random seed of the environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>seed (int): The seed to initialize the pseudo-random number generator.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.wrappers.Wrapper.step">
<code class="descname">step</code><span class="sig-paren">(</span><em>action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#Wrapper.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.Wrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the given action for one time step through the environment’s dynamics.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>action (object): a given action to the environment</dd>
<dt>Returns:</dt>
<dd>observation (object): The current observation agent receives after executing the given action.
reward (float): A scalar reward signal
done (bool): True if the episode terminates.
info (dict): Debugging information.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.wrappers.Wrapper.unwrapped">
<code class="descname">unwrapped</code><a class="headerlink" href="#lagom.envs.wrappers.Wrapper.unwrapped" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwrap this environment. Useful for sequential wrappers applied, it can access information from the original environment.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.wrappers.ObservationWrapper">
<em class="property">class </em><code class="descclassname">lagom.envs.wrappers.</code><code class="descname">ObservationWrapper</code><span class="sig-paren">(</span><em>env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#ObservationWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.ObservationWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Observation wrapper modifies the received observation after each function call of step() and reset().</p>
<p>Note that when observation is modified, the observation space should also be adjusted accordingly.</p>
<p>All inherited subclasses should at least implement the following functions:
1. process_observation(self, observation)
2. &#64;property: observation_space(self)</p>
<dl class="attribute">
<dt id="lagom.envs.wrappers.ObservationWrapper.observation_space">
<code class="descname">observation_space</code><a class="headerlink" href="#lagom.envs.wrappers.ObservationWrapper.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the observation space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.wrappers.ObservationWrapper.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#ObservationWrapper.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.ObservationWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the environment and return an initial observation.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observation (object): The observation agents receives for the initial state.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.wrappers.ObservationWrapper.step">
<code class="descname">step</code><span class="sig-paren">(</span><em>action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#ObservationWrapper.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.ObservationWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the given action for one time step through the environment’s dynamics.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>action (object): a given action to the environment</dd>
<dt>Returns:</dt>
<dd>observation (object): The current observation agent receives after executing the given action.
reward (float): A scalar reward signal
done (bool): True if the episode terminates.
info (dict): Debugging information.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.wrappers.ActionWrapper">
<em class="property">class </em><code class="descclassname">lagom.envs.wrappers.</code><code class="descname">ActionWrapper</code><span class="sig-paren">(</span><em>env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#ActionWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.ActionWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Action wrapper modifies the action before calling step() function.</p>
<p>Note that when action is modified, the action space should also be adjusted accordingly.</p>
<p>All inherited subclasses should at least implement the following functions:
1. process_action(self, action)
2. &#64;property: action_space(self)</p>
<dl class="attribute">
<dt id="lagom.envs.wrappers.ActionWrapper.action_space">
<code class="descname">action_space</code><a class="headerlink" href="#lagom.envs.wrappers.ActionWrapper.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the action space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.wrappers.ActionWrapper.step">
<code class="descname">step</code><span class="sig-paren">(</span><em>action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#ActionWrapper.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.ActionWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the given action for one time step through the environment’s dynamics.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>action (object): a given action to the environment</dd>
<dt>Returns:</dt>
<dd>observation (object): The current observation agent receives after executing the given action.
reward (float): A scalar reward signal
done (bool): True if the episode terminates.
info (dict): Debugging information.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.wrappers.RewardWrapper">
<em class="property">class </em><code class="descclassname">lagom.envs.wrappers.</code><code class="descname">RewardWrapper</code><span class="sig-paren">(</span><em>env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#RewardWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.RewardWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Reward wrapper modifies the received reward after each function call of step().</p>
<p>All inherited subclasses should at least implement the following functions:
1. process_reward(self, reward)</p>
<dl class="method">
<dt id="lagom.envs.wrappers.RewardWrapper.step">
<code class="descname">step</code><span class="sig-paren">(</span><em>action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/wrapper.html#RewardWrapper.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.RewardWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the given action for one time step through the environment’s dynamics.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>action (object): a given action to the environment</dd>
<dt>Returns:</dt>
<dd>observation (object): The current observation agent receives after executing the given action.
reward (float): A scalar reward signal
done (bool): True if the episode terminates.
info (dict): Debugging information.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.wrappers.StackObservation">
<em class="property">class </em><code class="descclassname">lagom.envs.wrappers.</code><code class="descname">StackObservation</code><span class="sig-paren">(</span><em>env</em>, <em>num_stack</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/stack_observation.html#StackObservation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.StackObservation" title="Permalink to this definition">¶</a></dt>
<dd><p>The observations are stacked, e.g. if the number of stacks is 4, then the returned
observation contains the most recent 4 observations.</p>
<p>Each time the step() is called, the stacked observation is updated by augmenting the
new observation and remove the oldest one.</p>
<p>Note that the observation sapce is enforced to be Box to make sure the observation is an array.</p>
<p>For example in ‘Pendulum-v0’, the observation is an array with the shape [3], if we stacks 4
observations, each step(), the returned observation will have shape [3, 4]</p>
<dl class="attribute">
<dt id="lagom.envs.wrappers.StackObservation.observation_space">
<code class="descname">observation_space</code><a class="headerlink" href="#lagom.envs.wrappers.StackObservation.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the observation space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.wrappers.StackObservation.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/stack_observation.html#StackObservation.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.StackObservation.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the state of the environment and return an initial observation.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observation (object): The observation agents receives for the initial state.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.wrappers.SparseReward">
<em class="property">class </em><code class="descclassname">lagom.envs.wrappers.</code><code class="descname">SparseReward</code><span class="sig-paren">(</span><em>env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/sparse_reward.html#SparseReward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.SparseReward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="lagom.envs.wrappers.PartialFlattenDict">
<em class="property">class </em><code class="descclassname">lagom.envs.wrappers.</code><code class="descname">PartialFlattenDict</code><span class="sig-paren">(</span><em>env</em>, <em>keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/partial_flatten_dict.html#PartialFlattenDict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.PartialFlattenDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns flattened observation from a dictionary space with partial keys into a Box space.</p>
<dl class="attribute">
<dt id="lagom.envs.wrappers.PartialFlattenDict.observation_space">
<code class="descname">observation_space</code><a class="headerlink" href="#lagom.envs.wrappers.PartialFlattenDict.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the observation space.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.wrappers.FlattenObservation">
<em class="property">class </em><code class="descclassname">lagom.envs.wrappers.</code><code class="descname">FlattenObservation</code><span class="sig-paren">(</span><em>env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/wrappers/flatten_observation.html#FlattenObservation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.wrappers.FlattenObservation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="lagom.envs.wrappers.FlattenObservation.observation_space">
<code class="descname">observation_space</code><a class="headerlink" href="#lagom.envs.wrappers.FlattenObservation.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the observation space.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="vectorized-environment">
<h2>Vectorized Environment<a class="headerlink" href="#vectorized-environment" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="lagom.envs.vec_env.VecEnv">
<em class="property">class </em><code class="descclassname">lagom.envs.vec_env.</code><code class="descname">VecEnv</code><span class="sig-paren">(</span><em>list_make_env</em>, <em>observation_space</em>, <em>action_space</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env.html#VecEnv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>An abstract class for asynchronous, vectorized environment.</p>
<p>Note that all vectorized environments should share the same observation and action spaces.</p>
<p>All inherited subclasses should at least implement the following functions:
1. step_asyn(self, actions)
2. step_wait(self)
3. reset(self)
4. render(self, mode=’human’)
5. close(self)
6. seed(self, seeds)
7. &#64;property: T(self)</p>
<dl class="attribute">
<dt id="lagom.envs.vec_env.VecEnv.T">
<code class="descname">T</code><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.T" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum horizon of the environment, if available</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.vec_env.VecEnv.action_space">
<code class="descname">action_space</code><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the action space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnv.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env.html#VecEnv.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.close" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be automatically called when garbage collected or program exited.</p>
<p>Override this method to do any further cleanup.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.vec_env.VecEnv.max_episode_reward">
<code class="descname">max_episode_reward</code><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.max_episode_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum episodic rewards of the environment, if available</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.vec_env.VecEnv.observation_space">
<code class="descname">observation_space</code><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the observation space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnv.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>mode='human'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env.html#VecEnv.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the vectorized environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mode (str): The mode for the rendering. Two modes are supported.</dt>
<dd><ul class="first last simple">
<li>‘human’: Often pop up a rendered window</li>
<li>‘rgb_array’: numpy array with shape [x, y, 3] for RGB values.</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnv.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env.html#VecEnv.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the states of all the environments and return a list of initial observations.</p>
<p>Note that the step_async() will be cancelled if it is still woring.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observations (list): The list of initial observations from all environments.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnv.seed">
<code class="descname">seed</code><span class="sig-paren">(</span><em>seeds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env.html#VecEnv.seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the random seeds for each of the environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>seeds (list): List of seeds to initialize the pseudo-random number generator</dt>
<dd>for all environments.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnv.step">
<code class="descname">step</code><span class="sig-paren">(</span><em>actions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env.html#VecEnv.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute all the given actions, each for one environment, for one time step through
the environments’ dynamics.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>actions (list): a list of given actions, each for one environment.</dd>
<dt>Returns:</dt>
<dd><dl class="first docutils">
<dt>observations (list of object): A list of current observations that agent receives from all </dt>
<dd>environments after executing the given actions.</dd>
</dl>
<p class="last">rewards (list of float): A list of scalar rewards from all environments. 
dones (list of bool): A list booleans from all environments. If True, then the episode terminates.
infos (list of dict): A list of debugging informations from all environments.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnv.step_async">
<code class="descname">step_async</code><span class="sig-paren">(</span><em>actions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env.html#VecEnv.step_async"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.step_async" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify all the environments to execute the given actions, each for one environment.</p>
<p>Call step_wait() to receive all the results.</p>
<p>Note that do not call this function if it is already pending.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>actions (list): a list of given actions, each for one environment.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnv.step_wait">
<code class="descname">step_wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env.html#VecEnv.step_wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.step_wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for the job in step_async() to finish and return all the results.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><dl class="first docutils">
<dt>observations (list of object): A list of current observations that agent receives from all </dt>
<dd>environments after executing the given actions.</dd>
</dl>
<p class="last">rewards (list of float): A list of scalar rewards from all environments. 
dones (list of bool): A list booleans from all environments. If True, then the episode terminates.
infos (list of dict): A list of debugging informations from all environments.</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.vec_env.VecEnv.unwrapped">
<code class="descname">unwrapped</code><a class="headerlink" href="#lagom.envs.vec_env.VecEnv.unwrapped" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwrap the vectorized environment.</p>
<p>Useful for sequential wrappers applied, it can access information from those environments.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.vec_env.SerialVecEnv">
<em class="property">class </em><code class="descclassname">lagom.envs.vec_env.</code><code class="descname">SerialVecEnv</code><span class="sig-paren">(</span><em>list_make_env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/serial_vec_env.html#SerialVecEnv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.SerialVecEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>Run vectorized environment serially.</p>
<p>Note that it is recommended to use this environment only if step() in the environment
needs very few computation, otherwise it will be slower than doing it parallelly. For ‘slow’ environment, 
it is recommended to use ParallelVecEnv instead.</p>
<dl class="docutils">
<dt>Examples:</dt>
<dd><dl class="first docutils">
<dt>def make_env():</dt>
<dd><p class="first">env = gym.make(‘CartPole-v0’)
env = GymEnv(env)</p>
<p class="last">return env</p>
</dd>
</dl>
<p>env = SerialVecEnv([make_env]*5)
env.reset()
for _ in range(100):</p>
<blockquote class="last">
<div>env.step([0]*5)</div></blockquote>
</dd>
</dl>
<dl class="attribute">
<dt id="lagom.envs.vec_env.SerialVecEnv.T">
<code class="descname">T</code><a class="headerlink" href="#lagom.envs.vec_env.SerialVecEnv.T" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum horizon of the environment, if available</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.SerialVecEnv.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/serial_vec_env.html#SerialVecEnv.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.SerialVecEnv.close" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be automatically called when garbage collected or program exited.</p>
<p>Override this method to do any further cleanup.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.vec_env.SerialVecEnv.max_episode_reward">
<code class="descname">max_episode_reward</code><a class="headerlink" href="#lagom.envs.vec_env.SerialVecEnv.max_episode_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum episodic rewards of the environment, if available</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.SerialVecEnv.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>mode='human'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/serial_vec_env.html#SerialVecEnv.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.SerialVecEnv.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the vectorized environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mode (str): The mode for the rendering. Two modes are supported.</dt>
<dd><ul class="first last simple">
<li>‘human’: Often pop up a rendered window</li>
<li>‘rgb_array’: numpy array with shape [x, y, 3] for RGB values.</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.SerialVecEnv.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/serial_vec_env.html#SerialVecEnv.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.SerialVecEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the states of all the environments and return a list of initial observations.</p>
<p>Note that the step_async() will be cancelled if it is still woring.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observations (list): The list of initial observations from all environments.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.SerialVecEnv.seed">
<code class="descname">seed</code><span class="sig-paren">(</span><em>seeds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/serial_vec_env.html#SerialVecEnv.seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.SerialVecEnv.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the random seeds for each of the environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>seeds (list): List of seeds to initialize the pseudo-random number generator</dt>
<dd>for all environments.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.SerialVecEnv.step_async">
<code class="descname">step_async</code><span class="sig-paren">(</span><em>actions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/serial_vec_env.html#SerialVecEnv.step_async"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.SerialVecEnv.step_async" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify all the environments to execute the given actions, each for one environment.</p>
<p>Call step_wait() to receive all the results.</p>
<p>Note that do not call this function if it is already pending.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>actions (list): a list of given actions, each for one environment.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.SerialVecEnv.step_wait">
<code class="descname">step_wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/serial_vec_env.html#SerialVecEnv.step_wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.SerialVecEnv.step_wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for the job in step_async() to finish and return all the results.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><dl class="first docutils">
<dt>observations (list of object): A list of current observations that agent receives from all </dt>
<dd>environments after executing the given actions.</dd>
</dl>
<p class="last">rewards (list of float): A list of scalar rewards from all environments. 
dones (list of bool): A list booleans from all environments. If True, then the episode terminates.
infos (list of dict): A list of debugging informations from all environments.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.vec_env.ParallelVecEnv">
<em class="property">class </em><code class="descclassname">lagom.envs.vec_env.</code><code class="descname">ParallelVecEnv</code><span class="sig-paren">(</span><em>list_make_env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/parallel_vec_env.html#ParallelVecEnv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.ParallelVecEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>Run vectorized environment in parallel. Each environment is running in an individual Process.</p>
<p>Note that it is recommended to use parallel vectorized environment only if the step() in the environment
needs quite some computation, otherwise it will be slower than doing it serially. For ‘fast’
environment, it is recommended to use SerialVecEnv instead.</p>
<p>Examples:</p>
<blockquote>
<div><dl class="docutils">
<dt>def make_env():</dt>
<dd><p class="first">env = gym.make(‘CartPole-v0’)
env = GymEnv(env)</p>
<p class="last">return env</p>
</dd>
</dl>
<p>env = ParallelVecEnv([make_env]*5)
env.reset()
for _ in range(100):</p>
<blockquote>
<div>env.step([0]*5)</div></blockquote>
</div></blockquote>
<dl class="attribute">
<dt id="lagom.envs.vec_env.ParallelVecEnv.T">
<code class="descname">T</code><a class="headerlink" href="#lagom.envs.vec_env.ParallelVecEnv.T" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum horizon of the environment, if available</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.ParallelVecEnv.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/parallel_vec_env.html#ParallelVecEnv.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.ParallelVecEnv.close" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be automatically called when garbage collected or program exited.</p>
<p>Override this method to do any further cleanup.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.vec_env.ParallelVecEnv.max_episode_reward">
<code class="descname">max_episode_reward</code><a class="headerlink" href="#lagom.envs.vec_env.ParallelVecEnv.max_episode_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum episodic rewards of the environment, if available</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.ParallelVecEnv.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>mode='human'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/parallel_vec_env.html#ParallelVecEnv.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.ParallelVecEnv.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the vectorized environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mode (str): The mode for the rendering. Two modes are supported.</dt>
<dd><ul class="first last simple">
<li>‘human’: Often pop up a rendered window</li>
<li>‘rgb_array’: numpy array with shape [x, y, 3] for RGB values.</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.ParallelVecEnv.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/parallel_vec_env.html#ParallelVecEnv.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.ParallelVecEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the states of all the environments and return a list of initial observations.</p>
<p>Note that the step_async() will be cancelled if it is still woring.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observations (list): The list of initial observations from all environments.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.ParallelVecEnv.seed">
<code class="descname">seed</code><span class="sig-paren">(</span><em>seeds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/parallel_vec_env.html#ParallelVecEnv.seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.ParallelVecEnv.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the random seeds for each of the environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>seeds (list): List of seeds to initialize the pseudo-random number generator</dt>
<dd>for all environments.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.ParallelVecEnv.step_async">
<code class="descname">step_async</code><span class="sig-paren">(</span><em>actions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/parallel_vec_env.html#ParallelVecEnv.step_async"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.ParallelVecEnv.step_async" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify all the environments to execute the given actions, each for one environment.</p>
<p>Call step_wait() to receive all the results.</p>
<p>Note that do not call this function if it is already pending.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>actions (list): a list of given actions, each for one environment.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.ParallelVecEnv.step_wait">
<code class="descname">step_wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/parallel_vec_env.html#ParallelVecEnv.step_wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.ParallelVecEnv.step_wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for the job in step_async() to finish and return all the results.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><dl class="first docutils">
<dt>observations (list of object): A list of current observations that agent receives from all </dt>
<dd>environments after executing the given actions.</dd>
</dl>
<p class="last">rewards (list of float): A list of scalar rewards from all environments. 
dones (list of bool): A list booleans from all environments. If True, then the episode terminates.
infos (list of dict): A list of debugging informations from all environments.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.vec_env.VecEnvWrapper">
<em class="property">class </em><code class="descclassname">lagom.envs.vec_env.</code><code class="descname">VecEnvWrapper</code><span class="sig-paren">(</span><em>venv</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env_wrapper.html#VecEnvWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="lagom.envs.vec_env.VecEnvWrapper.T">
<code class="descname">T</code><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.T" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum horizon of the environment, if available</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.vec_env.VecEnvWrapper.action_space">
<code class="descname">action_space</code><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the action space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnvWrapper.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env_wrapper.html#VecEnvWrapper.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.close" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be automatically called when garbage collected or program exited.</p>
<p>Override this method to do any further cleanup.</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.vec_env.VecEnvWrapper.max_episode_reward">
<code class="descname">max_episode_reward</code><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.max_episode_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum episodic rewards of the environment, if available</p>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.vec_env.VecEnvWrapper.observation_space">
<code class="descname">observation_space</code><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Space object to define the observation space.</p>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnvWrapper.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>mode='human'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env_wrapper.html#VecEnvWrapper.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the vectorized environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mode (str): The mode for the rendering. Two modes are supported.</dt>
<dd><ul class="first last simple">
<li>‘human’: Often pop up a rendered window</li>
<li>‘rgb_array’: numpy array with shape [x, y, 3] for RGB values.</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnvWrapper.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env_wrapper.html#VecEnvWrapper.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the states of all the environments and return a list of initial observations.</p>
<p>Note that the step_async() will be cancelled if it is still woring.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observations (list): The list of initial observations from all environments.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnvWrapper.seed">
<code class="descname">seed</code><span class="sig-paren">(</span><em>seeds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env_wrapper.html#VecEnvWrapper.seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the random seeds for each of the environment.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>seeds (list): List of seeds to initialize the pseudo-random number generator</dt>
<dd>for all environments.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnvWrapper.step_async">
<code class="descname">step_async</code><span class="sig-paren">(</span><em>actions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env_wrapper.html#VecEnvWrapper.step_async"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.step_async" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify all the environments to execute the given actions, each for one environment.</p>
<p>Call step_wait() to receive all the results.</p>
<p>Note that do not call this function if it is already pending.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>actions (list): a list of given actions, each for one environment.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.VecEnvWrapper.step_wait">
<code class="descname">step_wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/vec_env_wrapper.html#VecEnvWrapper.step_wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.step_wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for the job in step_async() to finish and return all the results.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><dl class="first docutils">
<dt>observations (list of object): A list of current observations that agent receives from all </dt>
<dd>environments after executing the given actions.</dd>
</dl>
<p class="last">rewards (list of float): A list of scalar rewards from all environments. 
dones (list of bool): A list booleans from all environments. If True, then the episode terminates.
infos (list of dict): A list of debugging informations from all environments.</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="lagom.envs.vec_env.VecEnvWrapper.unwrapped">
<code class="descname">unwrapped</code><a class="headerlink" href="#lagom.envs.vec_env.VecEnvWrapper.unwrapped" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwrap the vectorized environment.</p>
<p>Useful for sequential wrappers applied, it can access information from those environments.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.vec_env.StandardizeVecEnv">
<em class="property">class </em><code class="descclassname">lagom.envs.vec_env.</code><code class="descname">StandardizeVecEnv</code><span class="sig-paren">(</span><em>venv</em>, <em>use_obs=True</em>, <em>use_reward=True</em>, <em>clip_obs=10.0</em>, <em>clip_reward=10.0</em>, <em>gamma=0.99</em>, <em>eps=1e-08</em>, <em>constant_obs_mean=None</em>, <em>constant_obs_std=None</em>, <em>constant_reward_std=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/standardize_vec_env.html#StandardizeVecEnv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.StandardizeVecEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>Standardize the observations and rewards by using running average. 
i.e. subtract by running mean and divided by running standard deviation.</p>
<p>Or the user can also provide constant mean and standard deviation for standardization.</p>
<p>Note that we do not subtract the mean from rewards but only divided by standard deviation. 
And the reward running average is computed by discounted returns continuously.</p>
<p>Also note that each <cite>reset()</cite> we do not clean up the <cite>self.all_returns</cite> buffer. 
Because of discount factor (&lt; 1), the running averages will be converged after some iterations. 
Therefore, we do not allow discounted factor as 1.0, as it will lead to unbounded explosion 
of reward running averages.</p>
<p>IMPORTANT: Remember to save and load observation scaling for evaluating the agent.</p>
<p>Examples:</p>
<blockquote>
<div><dl class="docutils">
<dt>list_make_env = make_envs(make_env=make_gym_env, </dt>
<dd>env_id=’Pendulum-v0’, 
num_env=2, 
init_seed=1)</dd>
</dl>
<p>venv = SerialVecEnv(list_make_env=list_make_env)</p>
<dl class="docutils">
<dt>env = StandardizeVecEnv(venv=venv, </dt>
<dd>use_obs=True, 
use_reward=True, 
clip_obs=10.0, 
clip_reward=10.0, 
gamma=0.99, 
eps=1e-8)</dd>
</dl>
</div></blockquote>
<dl class="method">
<dt id="lagom.envs.vec_env.StandardizeVecEnv.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/standardize_vec_env.html#StandardizeVecEnv.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.StandardizeVecEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the states of all the environments and return a list of initial observations.</p>
<p>Note that the step_async() will be cancelled if it is still woring.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>observations (list): The list of initial observations from all environments.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="lagom.envs.vec_env.StandardizeVecEnv.step_wait">
<code class="descname">step_wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/standardize_vec_env.html#StandardizeVecEnv.step_wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.StandardizeVecEnv.step_wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for the job in step_async() to finish and return all the results.</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd><dl class="first docutils">
<dt>observations (list of object): A list of current observations that agent receives from all </dt>
<dd>environments after executing the given actions.</dd>
</dl>
<p class="last">rewards (list of float): A list of scalar rewards from all environments. 
dones (list of bool): A list booleans from all environments. If True, then the episode terminates.
infos (list of dict): A list of debugging informations from all environments.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lagom.envs.vec_env.CloudpickleWrapper">
<em class="property">class </em><code class="descclassname">lagom.envs.vec_env.</code><code class="descname">CloudpickleWrapper</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lagom/envs/vec_env/utils.html#CloudpickleWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#lagom.envs.vec_env.CloudpickleWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses cloudpickle to serialize contents (multiprocessing uses pickle by default)</p>
<p>This is useful when passing lambda definition through Process arguments.</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="experiment.html" class="btn btn-neutral float-right" title="lagom.experiment" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="engine.html" class="btn btn-neutral" title="lagom.engine" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Xingdong Zuo.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>